<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --orange: #FFA500;
      --orange-2: #FFB84D;
      --blue: #0047AB;
      --blue-2: #0066CC;
      --white: #FFFFFF;
      --glass: rgba(255, 255, 255, 0.9);
    }

    body {
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(135deg, var(--orange) 0%, #ffffff 60%, var(--blue));
      color: #002366;
      margin: 0;
      padding: 0;
      -webkit-font-smoothing: antialiased;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 18px;
    }

    .btn-nav {
      padding: 8px 14px;
      border: none;
      border-radius: 10px;
      background: var(--glass);
      color: #002366;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.06);
      transition: transform .15s ease;
    }

    h1 {
      text-align: center;
      margin: 8px 0 12px;
      font-size: 1.6rem;
      color: #002366;
    }

    .container {
      display: flex;
      gap: 12px;
      padding: 12px;
      align-items: flex-start;
    }

    .order-summary {
      width: 320px;
      background: var(--glass);
      border-radius: 16px;
      padding: 14px;
      margin-right: 8px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    }

    .order-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .order-item .controls button {
      font-size: 0.95rem;
      width: 32px;
      height: 32px;
      border: none;
      border-radius: 8px;
      background: var(--orange);
      color: white;
      cursor: pointer;
      font-weight: 700;
    }

    .summary-total {
      margin-top: 12px;
      font-weight: 700;
      color: #002366;
      text-align: center;
    }

    .menu-grid {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 14px;
    }

    .menu-item {
      background: #ffffff;
      border-radius: 14px;
      text-align: center;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
      padding: 12px;
      cursor: pointer;
      transition: transform .14s ease;
    }
    .menu-item:hover { transform: translateY(-6px); }

    .image-placeholder {
      width: 100%;
      height: 110px;
      background: #eee;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 10px;
    }

    /* üß∫ Floating Cart Icon */
    #cartIcon {
      position: fixed;
      top: 12px;
      right: 16px;
      background: #0047AB;
      color: white;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      display: none;
      justify-content: center;
      align-items: center;
      font-size: 22px;
      cursor: pointer;
      z-index: 2000;
      box-shadow: 0 4px 10px rgba(0,0,0,0.25);
    }
    #cartIcon span {
      position: absolute;
      top: -6px;
      right: -6px;
      background: red;
      color: white;
      border-radius: 50%;
      font-size: 12px;
      width: 20px;
      height: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    @media (max-width:768px){
      #cartIcon{display:flex;}
      .order-summary{display:none !important;}
    }

    .popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      padding: 20px;
      border-radius: 14px;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
      z-index: 1500;
      width: 320px;
      text-align: center;
      display: none;
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.45);
      display: none;
      z-index: 1400;
    }
  </style>
</head>

<body>
  <div class="overlay" id="overlay" onclick="closeAllPopups()"></div>
  <header>
    <button class="btn-nav" onclick="playClick();goHome()">‚Üê Home</button>
    <button class="btn-nav" onclick="playClick();goBack()">‚Üê Back</button>
  </header>

  <h1>‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h1>

  <!-- üß∫ Floating Cart Icon -->
  <div id="cartIcon" onclick="playClick();showCartPopup()">
    üß∫<span id="cartCount">0</span>
  </div>

  <div class="container">
    <div class="order-summary" id="orderSummary" style="display:none;">
      <h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
      <div id="orderItems"></div>
      <div class="summary-total" id="totalSummary"></div>
      <button onclick="playClick();promptDiscountAuth()">üéÅ ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</button>
      <button onclick="playClick();submitOrder()">‚úÖ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
      <button onclick="playClick();cancelOrder()">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      <button onclick="playClick();removeDiscount()">üßπ ‡∏•‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</button>
    </div>

    <div class="menu-grid" id="menuGrid">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏ô‡∏π...</div>
  </div>

  <!-- Popup ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ -->
  <div class="popup" id="mobileCartPopup">
    <h3>üõí ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
    <div id="mobileOrderItems"></div>
    <div id="mobileTotalSummary" style="margin:10px 0;font-weight:600;"></div>
    <button onclick="playClick();promptDiscountAuth()">üéÅ ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</button>
    <button onclick="playClick();submitOrder()">‚úÖ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
    <button onclick="playClick();cancelOrder()">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
    <button onclick="playClick();removeDiscount()">üßπ ‡∏•‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</button>
  </div>

  <script>
    let order={}, discountPercent=0;

    function showPopup(id){document.getElementById('overlay').style.display='block';document.getElementById(id).style.display='block';}
    function closeAllPopups(){document.querySelectorAll('.popup').forEach(p=>p.style.display='none');document.getElementById('overlay').style.display='none';}

    function promptDiscountAuth(){alert("‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (‡∏à‡∏≥‡∏•‡∏≠‡∏á)");}
    function removeDiscount(){discountPercent=0;updateSummary();updateCartCount();}
    function cancelOrder(){if(confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠?")){order={};updateSummary();updateCartCount();}}

    function addToOrder(item){
      const n=item.name,p=Number(item.price);
      if(!order[n])order[n]={price:p,quantity:1};
      else order[n].quantity++;
      updateSummary();updateCartCount();
    }

    function updateSummary(){
      const s=document.getElementById('orderSummary'),
            items=document.getElementById('orderItems'),
            t=document.getElementById('totalSummary');
      items.innerHTML='';
      let subtotal=0;
      for(const n in order){
        const it=order[n];
        subtotal+=it.price*it.quantity;
        items.innerHTML+=`<div class='order-item'>
          <div>${n}</div>
          <div class='controls'>
            <button onclick="playClick();changeQty('${n}',-1)">-</button>
            <span>${it.quantity}</span>
            <button onclick="playClick();changeQty('${n}',1)">+</button>
            <button onclick="playClick();removeItem('${n}')">üóëÔ∏è</button>
          </div></div>`;
      }
      const discount=subtotal*(discountPercent/100), vat=(subtotal-discount)*0.07, net=subtotal-discount+vat;
      t.innerHTML=`‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${subtotal.toFixed(2)} ‡∏ø<br>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (${discountPercent}%): ${discount.toFixed(2)} ‡∏ø<br>VAT 7%: ${vat.toFixed(2)} ‡∏ø<br><strong>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ${net.toFixed(2)} ‡∏ø</strong>`;
      s.style.display=Object.keys(order).length?'block':'none';
    }

    function changeQty(n,c){if(order[n]){order[n].quantity+=c;if(order[n].quantity<=0)delete order[n];updateSummary();updateCartCount();}}
    function removeItem(n){delete order[n];updateSummary();updateCartCount();}

    function updateCartCount(){
      const count=Object.values(order).reduce((a,b)=>a+b.quantity,0);
      document.getElementById('cartCount').textContent=count;
    }

    function showCartPopup(){
      if(Object.keys(order).length===0){alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠");return;}
      const mobileItems=document.getElementById('mobileOrderItems');
      let subtotal=0;mobileItems.innerHTML='';
      for(const n in order){
        const it=order[n];
        subtotal+=it.price*it.quantity;
        mobileItems.innerHTML+=`<div>${n} x ${it.quantity} = ${(it.price*it.quantity).toFixed(2)}‡∏ø</div>`;
      }
      document.getElementById('mobileTotalSummary').innerText=`‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${subtotal.toFixed(2)}‡∏ø`;
      showPopup('mobileCartPopup');
    }

    function submitOrder(){alert("‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß!");}

    function goHome(){window.location.href='index.html';}
    function goBack(){window.history.back();}

    fetch("https://script.google.com/macros/s/AKfycbwvYTBu1lZ-IukUtsg2ylzALbEEoYARxjgyWh7VmTDP9lTXhs6Axv7uNcRIE3DCGjaQ/exec")
      .then(r=>r.json()).then(data=>{
        const g=document.getElementById('menuGrid');
        g.innerHTML='';
        data.forEach(it=>{
          const d=document.createElement('div');
          d.className='menu-item';
          d.innerHTML=`<div class='image-placeholder'>[‡∏£‡∏π‡∏õ‡∏≠‡∏≤‡∏´‡∏≤‡∏£]</div><div>${it.name}</div><div>${it.price} ‡∏ö‡∏≤‡∏ó</div>`;
          d.onclick=()=>{playClick();addToOrder(it);};
          g.appendChild(d);
        });
      });

    /* üîä ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á */
    let audioCtx;
    function initAudio(){if(!audioCtx)audioCtx=new(window.AudioContext||window.webkitAudioContext)();}
    function playClick(){
      initAudio();
      const o=audioCtx.createOscillator(),g=audioCtx.createGain();
      o.connect(g);g.connect(audioCtx.destination);
      o.type="square";o.frequency.value=550;g.gain.value=0.08;
      o.start();o.stop(audioCtx.currentTime+0.1);
      if(navigator.vibrate)navigator.vibrate(30);
    }
    function playError(){
      initAudio();
      const o=audioCtx.createOscillator(),g=audioCtx.createGain();
      o.connect(g);g.connect(audioCtx.destination);
      o.type="sawtooth";o.frequency.value=200;g.gain.value=0.1;
      o.start();o.stop(audioCtx.currentTime+0.25);
      if(navigator.vibrate)navigator.vibrate([80,40,80]);
    }
    const _alert=window.alert;
    window.alert=function(msg){playError();_alert(msg);}
  </script>
</body>
</html>
